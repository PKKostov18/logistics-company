<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Clients List - LogiTrace</title>
    <div th:replace="~{layout/common-layout :: head-content}"></div>

    <link rel="stylesheet" th:href="@{/css/home.css}">
    <link rel="stylesheet" th:href="@{/css/clients.css}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="theme-light">

<div th:replace="~{layout/common-layout :: navigation}"></div>

<main class="main-content">

    <div class="page-header" style="margin-bottom: 1.5rem; display: flex; justify-content: space-between; align-items: center;">
        <h1 style="font-size: 1.5rem; font-weight: 700; color: var(--color-text);">
            <i class="fa-solid fa-users" style="color: #373c73; margin-right: 10px;"></i>
            Clients Management
        </h1>
        <div class="actions">
        </div>
    </div>

    <div class="table-responsive">
        <table class="clients-table">
            <thead>
            <tr>
                <th style="width: 5%;">ID</th>
                <th style="width: 30%;">Name</th>
                <th style="width: 25%;">Phone Number</th>
                <th style="width: 20%;">Username</th>
                <th style="width: 20%; text-align: right;">Actions</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="client : ${clients}" th:data-id="${client.id}">
                <td th:text="${client.id}" style="color: #6b7280; font-family: monospace;">1</td>

                <td>
                    <span class="view-field name-text" th:text="${client.name}">Client Name</span>
                    <input type="text" class="edit-field edit-input" name="name" th:value="${client.name}" style="display: none;">
                </td>

                <td>
                    <span class="view-field phone-text" th:text="${client.phoneNumber}">0888123456</span>
                    <input type="text" class="edit-field edit-input" name="phoneNumber" th:value="${client.phoneNumber}" style="display: none;">
                </td>

                <td>
                    <span class="username-badge"
                          th:text="${client.user != null ? '@' + client.user.username : 'Guest'}">@user</span>
                </td>

                <td style="text-align: right;">
                    <div class="view-actions">
                        <button type="button" class="btn-sm btn-edit" onclick="enableEdit(this)">
                            <i class="fa-solid fa-pen"></i> Edit
                        </button>
                        <form th:action="@{/clients/delete/{id}(id=${client.id})}" method="post" style="display:inline;"
                              onsubmit="return confirm('Are you sure? This will delete associated packages too!');">
                            <button type="submit" class="btn-sm btn-delete">
                                <i class="fa-solid fa-trash"></i>
                            </button>
                        </form>
                    </div>

                    <div class="edit-actions" style="display: none;">
                        <button type="button" class="btn-sm btn-save" onclick="updateClient(this)">
                            <i class="fa-solid fa-check"></i>
                        </button>
                        <button type="button" class="btn-sm btn-cancel" onclick="cancelEdit(this)">
                            <i class="fa-solid fa-xmark"></i>
                        </button>
                    </div>
                </td>
            </tr>

            <tr th:if="${clients.isEmpty()}">
                <td colspan="5" style="text-align: center; padding: 3rem; color: #9ca3af;">
                    <i class="fa-solid fa-users-slash" style="font-size: 2rem; margin-bottom: 1rem; display: block;"></i>
                    No clients found.
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</main>

<div th:replace="~{layout/common-layout :: footer}"></div>
<script th:src="@{/js/theme.js}"></script>
<script th:src="@{/js/menu.js}"></script>
<script th:src="@{/js/clients.js}"></script>
</body>
</html>