<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Pending Shipments</title>
    <div th:replace="~{layout/common-layout :: head-content}"></div>

    <link rel="stylesheet" th:href="@{/css/home.css}">
    <link rel="stylesheet" th:href="@{/css/packages.css}"> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="theme-light">

<div th:replace="~{layout/common-layout :: navigation}"></div>

<main class="main-content">
    <div class="page-header">
        <h1 class="page-title">
            <i class="fa-solid fa-clock-rotate-left icon-pending"></i>
            Pending Shipments
        </h1>
    </div>

    <div class="table-responsive">
        <table class="packages-table">
            <thead>
            <tr>
                <th>Tracking #</th>
                <th>Sender</th>
                <th>Receiver</th>
                <th class="text-center">Status</th>
                <th class="text-center">Actions</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="pkg : ${packages}">
                <td>
                    <span class="tracking-badge" th:text="${pkg.trackingNumber}">TRK-123</span>
                    <div class="sub-text" th:text="${pkg.destinationOffice != null ? 'To: ' + pkg.destinationOffice : 'To Address'}">Location</div>
                </td>

                <td>
                    <div class="user-name" th:text="${pkg.senderName}">Sender Name</div>
                    <div class="sub-text" th:text="${pkg.senderPhone}">Phone</div>
                </td>

                <td>
                    <div class="user-name" th:text="${pkg.receiverName}">Receiver Name</div>
                    <div class="sub-text" th:text="${pkg.receiverPhone}">Phone</div>
                </td>

                <td>
                    <span class="status-badge"
                          th:classappend="'status-' + ${pkg.status}"
                          th:text="${pkg.status}">STATUS</span>
                </td>

                <td class="text-right">
                    <form th:if="${pkg.status.name() == 'REGISTERED'}"
                          th:action="@{/packages/status/update}" method="post" class="action-form">
                        <input type="hidden" name="id" th:value="${pkg.id}">
                        <input type="hidden" name="status" value="IN_TRANSIT">
                        <button type="submit" class="btn-action btn-ship">
                            <i class="fa-solid fa-truck-fast"></i> Ship
                        </button>
                    </form>

                    <form th:if="${pkg.status.name() == 'IN_TRANSIT' or pkg.status.name() == 'REGISTERED'}"
                          th:action="@{/packages/status/update}" method="post" class="action-form">
                        <input type="hidden" name="id" th:value="${pkg.id}">
                        <input type="hidden" name="status" value="DELIVERED">
                        <button type="submit" class="btn-action btn-deliver">
                            <i class="fa-solid fa-check"></i> Deliver
                        </button>
                    </form>
                </td>
            </tr>

            <tr th:if="${packages.isEmpty()}">
                <td colspan="5" class="empty-state-cell">
                    <i class="fa-solid fa-clipboard-check empty-state-icon"></i>
                    No pending shipments found. Good job!
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</main>

<div th:replace="~{layout/common-layout :: footer}"></div>
<script th:src="@{/js/theme.js}"></script>
<script th:src="@{/js/menu.js}"></script>
</body>
</html>