<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Manage Offices - LogiTrace</title>
    <div th:replace="~{layout/common-layout :: head-content}"></div>

    <link rel="stylesheet" th:href="@{/css/home.css}">
    <link rel="stylesheet" th:href="@{/css/offices.css}"> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="theme-light">

<div th:replace="~{layout/common-layout :: navigation}"></div>

<main class="offices-container">

    <div style="margin-bottom: 2rem;">
        <h1 style="font-size: 1.8rem; font-weight: 700; color: var(--color-text);">
            <i class="fa-solid fa-building" style="color: #3b82f6; margin-right: 10px;"></i>
            Manage Offices
        </h1>
    </div>

    <div class="office-card">
        <h3 style="margin-bottom: 1rem; color: var(--color-text);">Add New Office</h3>
        <form th:action="@{/admin/offices/add}" method="post" th:object="${newOffice}" class="office-form">

            <div class="form-group">
                <label class="form-label">Office Name</label>
                <label>
                    <input type="text" th:field="*{name}" placeholder="e.g. Central Station" class="form-input" required>
                </label>
            </div>

            <div class="form-group">
                <label class="form-label">Address</label>
                <label>
                    <input type="text" th:field="*{address}" placeholder="City, Street 123" class="form-input" required>
                </label>
            </div>

            <div style="flex: 0 0 auto;">
                <button type="submit" class="btn-action btn-add">
                    <i class="fa-solid fa-plus"></i> Add Office
                </button>
            </div>
        </form>
    </div>

    <div class="table-wrapper">
        <table class="offices-table">
            <thead>
            <tr>
                <th style="width: 30%;">Name</th>
                <th style="width: 50%;">Address</th>
                <th style="width: 20%; text-align: right;">Actions</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="office : ${offices}">
                <td colspan="3" style="padding: 0;">
                    <form th:action="@{/admin/offices/update/{id}(id=${office.id})}" method="post" style="display: contents;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <tr>
                                <td style="width: 30%; border: none;">
                                    <label>
                                        <input type="text" name="name" th:value="${office.name}" class="table-input" required>
                                    </label>
                                </td>
                                <td style="width: 50%; border: none;">
                                    <label>
                                        <input type="text" name="address" th:value="${office.address}" class="table-input" required>
                                    </label>
                                </td>
                                <td style="width: 20%; text-align: right; border: none;">
                                    <button type="submit" class="btn-action btn-save" title="Save Changes">
                                        <i class="fa-solid fa-floppy-disk"></i>
                                    </button>

                                    <button type="button" class="btn-action btn-delete"
                                            th:onclick="'if(confirm(\'Are you sure?\')) document.getElementById(\'delete-form-' + ${office.id} + '\').submit()'"
                                            title="Delete Office">
                                        <i class="fa-solid fa-trash"></i>
                                    </button>
                                </td>
                            </tr>
                        </table>
                    </form>

                    <form th:id="'delete-form-' + ${office.id}"
                          th:action="@{/admin/offices/delete/{id}(id=${office.id})}"
                          method="post" style="display:none;">
                    </form>
                </td>
            </tr>

            <tr th:if="${#lists.isEmpty(offices)}">
                <td colspan="3" class="empty-state">
                    <i class="fa-regular fa-building" style="font-size: 2rem; margin-bottom: 1rem; display: block;"></i>
                    No offices found.
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</main>

<div th:replace="~{layout/common-layout :: footer}"></div>
<script th:src="@{/js/theme.js}"></script>
<script th:src="@{/js/menu.js}"></script>

</body>
</html>